import{V as S,e as C,f as g,p as $,o as O,q as z,a as T,c as k,b as i,g as F,t as _,l as M,s as E,F as D}from"./index-Cc3IqEh_.js";import{_ as X,M as q}from"./ButtonToggle.vue_vue_type_script_setup_true_lang-7yhGyEhP.js";class Y{constructor(s,u){this.pos=new S(s,u),this.vel=new S(0,0),this.neighbors=[]}detectNeighbors(s,u,n){const r=new S(Math.floor(this.pos.x/n),Math.floor(this.pos.y/n));this.neighbors=[];for(let c=-1;c<=1;c++)for(let v=-1;v<=1;v++){const m=r.x+c,x=r.y+v;if(m>=0&&m<s.width/n&&x>=0&&x<s.height/n)for(const p of u[m][x])p!==this&&p.pos.distance(this.pos)<n&&this.neighbors.push(p)}}repelNeighbors(s,u){for(const n of this.neighbors){const r=this.pos.clone().subtract(n.pos),c=(s-r.magnitude())**2;r.normalize(),r.multiplyScalar(c*u),this.vel.add(r)}}wallForce(s,u){this.pos.x<u?this.vel.x+=u/this.pos.x:this.pos.x>s.width-u&&(this.vel.x-=u/(s.width-this.pos.x)),this.pos.y<u?this.vel.y+=u/this.pos.y:this.pos.y>s.height-u&&(this.vel.y-=u/(s.height-this.pos.y))}move(s,u,n,r,c){this.vel.y+=u,this.vel.multiplyScalar(1-n),this.vel.magnitude()>r&&(this.vel.normalize(),this.vel.multiplyScalar(r)),this.pos.add(this.vel),this.pos.x<0?this.pos.x=1:this.pos.x>s.width&&(this.pos.x=Math.floor(s.width-1)),this.pos.y<0?this.pos.y=1:this.pos.y>s.height&&(this.pos.y=Math.floor(s.height-1))}draw(s){s.fillStyle="white",s.beginPath(),s.arc(this.pos.x,this.pos.y,2,0,Math.PI*2),s.fill()}}const A=i("h2",null,"Fluid Simulation",-1),H={class:"flex flex-row flex-wrap gap-5 justify-center w-full"},J={class:"flex flex-col gap-4 min-w-60"},K={class:"flex flex-row flex-wrap gap-2 justify-center"},Q={class:"flex flex-col"},W={class:"flex flex-col"},Z={class:"flex flex-col"},R={class:"flex flex-col"},ee={class:"flex flex-col"},te={class:"flex flex-row gap-2 justify-between items-center"},le={class:""},oe=i("canvas",{id:"fluidsimulation",class:"w-full max-w-md h-auto"},null,-1),V=500,se=C({__name:"DemoFluid",setup(U){let s;const u=g(25),n=$(()=>V/Math.round(V/u.value)),r=g(.04),c=g(.2),v=g(.005),m=g(10),x=g(100),p=g("create"),N=g(!0);let f=[],L=[];O(()=>{const e=document.getElementById("fluidsimulation"),t=e.getContext("2d");t.imageSmoothingEnabled=!0,e.width=V,e.height=V;for(let a=0;a<100;a++)f.push(new Y(Math.random()*e.width,Math.random()*e.height));s=setInterval(()=>{t.fillStyle="black",t.fillRect(0,0,e.width,e.height),l&&o&&(p.value=="create"?j(e,d,h):B(e,d,h)),x.value=f.length,t.fillStyle="white",I(e,L),N.value&&P(t,e,L);for(let a of f)a.wallForce(e,n.value),a.detectNeighbors(e,L,n.value),a.repelNeighbors(n.value,r.value);for(let a of f)a.move(e,c.value,v.value,m.value,n.value),a.draw(t)},1e3/60);let l=!1,o=!1,d=0,h=0;const y=a=>{l=!0,o=!0,a instanceof MouseEvent?(d=a.clientX,h=a.clientY):a instanceof TouchEvent&&(d=a.touches[0].clientX,h=a.touches[0].clientY)},w=()=>{l=!1},b=a=>{a.preventDefault(),l&&(a instanceof MouseEvent?(d=a.clientX,h=a.clientY):a instanceof TouchEvent&&(d=a.touches[0].clientX,h=a.touches[0].clientY))};e.addEventListener("mousedown",y),e.addEventListener("touchstart",y),e.addEventListener("mouseenter",()=>{o=!0}),e.addEventListener("mouseleave",()=>{o=!1}),window.addEventListener("mouseup",w),e.addEventListener("touchend",w),e.addEventListener("touchcancel",w),e.addEventListener("mousemove",b),e.addEventListener("touchmove",b)});const j=(e,t,l)=>{if(f.length>1e3)return;const o=e.getBoundingClientRect();if(t<o.left||t>=o.right||l<o.top||l>=o.bottom)return;const d=e.width/o.width,h=e.height/o.height,y=(t-o.left)*d,w=(l-o.top)*h,b=new Y(y,w);f.push(b)},B=(e,t,l)=>{const o=e.getBoundingClientRect(),d=e.width/o.width,h=e.height/o.height,y=(t-o.left)*d,w=(l-o.top)*h;f=f.filter(b=>b.pos.distance(new S(y,w))>50)},G=()=>{f.splice(0,f.length)},I=(e,t)=>{for(let l=0;l<=e.width/n.value;l++){t[l]=[];for(let o=0;o<=e.height/n.value;o++)t[l][o]=[]}for(let l of f)t[Math.floor(l.pos.x/n.value)][Math.floor(l.pos.y/n.value)].push(l)},P=(e,t,l)=>{for(let o=0;o<t.width/n.value;o++)for(let d=0;d<t.height/n.value;d++){let h=l[o][d].length;e.fillStyle="rgba(255, 255, 255, "+h/10+")",e.fillRect(o*n.value,d*n.value,n.value,n.value)}};return z(()=>{clearInterval(s)}),(e,t)=>(T(),k(D,null,[A,i("div",H,[i("div",J,[i("div",K,[F(X,{value:"create",text:"Create",modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=l=>p.value=l)},null,8,["modelValue"]),F(X,{value:"delete",text:"Delete",modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=l=>p.value=l)},null,8,["modelValue"]),i("button",{onClick:G,class:"border border-white p-2"},"Clear")]),i("div",Q,[i("span",null,"Search Radius "+_(n.value.toFixed(2)),1),M(i("input",{type:"range",min:"10",max:"100","onUpdate:modelValue":t[2]||(t[2]=l=>u.value=l),class:"w-full"},null,512),[[E,u.value,void 0,{number:!0}]])]),i("div",W,[i("span",null,"Repel Force "+_(r.value),1),M(i("input",{type:"range",min:"0",max:"0.1",step:"0.001","onUpdate:modelValue":t[3]||(t[3]=l=>r.value=l),class:"w-full"},null,512),[[E,r.value,void 0,{number:!0}]])]),i("div",Z,[i("span",null,"Gravity "+_(c.value),1),M(i("input",{type:"range",min:"0",max:"1",step:"0.1","onUpdate:modelValue":t[4]||(t[4]=l=>c.value=l),class:"w-full"},null,512),[[E,c.value,void 0,{number:!0}]])]),i("div",R,[i("span",null,"Friction "+_(v.value),1),M(i("input",{type:"range",min:"0",max:"1",step:"0.01","onUpdate:modelValue":t[5]||(t[5]=l=>v.value=l),class:"w-full"},null,512),[[E,v.value,void 0,{number:!0}]])]),i("div",ee,[i("span",null,"Max Speed "+_(m.value),1),M(i("input",{type:"range",min:"1",max:"20","onUpdate:modelValue":t[6]||(t[6]=l=>m.value=l),class:"w-full"},null,512),[[E,m.value,void 0,{number:!0}]])]),i("div",te,[i("span",le,"Particles: "+_(x.value),1),i("button",{class:"border border-white p-2",onClick:t[7]||(t[7]=l=>N.value=!N.value)}," Toggle grid ")])]),oe])],64))}}),ne=i("br",null,null,-1),ue=C({__name:"FluidView",setup(U){return(s,u)=>(T(),k(D,null,[F(se),ne,F(q,{filename:"Fluid"})],64))}});export{ue as default};
