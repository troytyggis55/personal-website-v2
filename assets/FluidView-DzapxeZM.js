import{V as S,e as C,f as g,p as I,o as P,q as O,a as T,c as k,b as a,g as F,t as _,l as M,s as E,F as z}from"./index-BWHCBHlE.js";import{_ as X,M as q}from"./ButtonToggle.vue_vue_type_script_setup_true_lang-olKP3wZa.js";class Y{constructor(s,u){this.pos=new S(s,u),this.vel=new S(0,0),this.neighbors=[]}detectNeighbors(s,u,n){const r=new S(Math.floor(this.pos.x/n),Math.floor(this.pos.y/n));this.neighbors=[];for(let c=-1;c<=1;c++)for(let v=-1;v<=1;v++){const m=r.x+c,x=r.y+v;if(m>=0&&m<s.width/n&&x>=0&&x<s.height/n)for(const p of u[m][x])p!==this&&p.pos.distance(this.pos)<n&&this.neighbors.push(p)}}repelNeighbors(s,u){for(const n of this.neighbors){const r=this.pos.clone().subtract(n.pos),c=(s-r.magnitude())**2;r.normalize(),r.multiplyScalar(c*u),this.vel.add(r)}}wallForce(s,u){this.pos.x<u?this.vel.x+=u/this.pos.x:this.pos.x>s.width-u&&(this.vel.x-=u/(s.width-this.pos.x)),this.pos.y<u?this.vel.y+=u/this.pos.y:this.pos.y>s.height-u&&(this.vel.y-=u/(s.height-this.pos.y))}move(s,u,n,r,c){this.vel.y+=u,this.vel.multiplyScalar(1-n),this.vel.magnitude()>r&&(this.vel.normalize(),this.vel.multiplyScalar(r)),this.pos.add(this.vel),this.pos.x<0?this.pos.x=1:this.pos.x>s.width&&(this.pos.x=Math.floor(s.width-1)),this.pos.y<0?this.pos.y=1:this.pos.y>s.height&&(this.pos.y=Math.floor(s.height-1))}draw(s){s.fillStyle="white",s.beginPath(),s.arc(this.pos.x,this.pos.y,2,0,Math.PI*2),s.fill()}}const A={class:"flex flex-row flex-wrap gap-5 justify-center w-full"},H={class:"flex flex-col gap-4 min-w-60"},J={class:"flex flex-row flex-wrap gap-2 justify-center"},K={class:"flex flex-col"},Q={class:"flex flex-col"},W={class:"flex flex-col"},Z={class:"flex flex-col"},R={class:"flex flex-col"},ee={class:"flex flex-row gap-2 justify-between items-center"},te={class:""},le=a("canvas",{id:"fluidsimulation",class:"w-full max-w-md h-auto"},null,-1),V=500,oe=C({__name:"DemoFluid",setup(U){let s;const u=g(25),n=I(()=>V/Math.round(V/u.value)),r=g(.04),c=g(.2),v=g(.005),m=g(10),x=g(100),p=g("create"),N=g(!0);let f=[],L=[];P(()=>{const e=document.getElementById("fluidsimulation"),t=e.getContext("2d");t.imageSmoothingEnabled=!0,e.width=V,e.height=V;for(let i=0;i<100;i++)f.push(new Y(Math.random()*e.width,Math.random()*e.height));s=setInterval(()=>{t.fillStyle="black",t.fillRect(0,0,e.width,e.height),l&&o&&(p.value=="create"?D(e,d,h):j(e,d,h)),x.value=f.length,t.fillStyle="white",$(e,L),N.value&&G(t,e,L);for(let i of f)i.wallForce(e,n.value),i.detectNeighbors(e,L,n.value),i.repelNeighbors(n.value,r.value);for(let i of f)i.move(e,c.value,v.value,m.value,n.value),i.draw(t)},1e3/60);let l=!1,o=!1,d=0,h=0;const y=i=>{l=!0,o=!0,i instanceof MouseEvent?(d=i.clientX,h=i.clientY):i instanceof TouchEvent&&(d=i.touches[0].clientX,h=i.touches[0].clientY)},w=()=>{l=!1},b=i=>{i.preventDefault(),l&&(i instanceof MouseEvent?(d=i.clientX,h=i.clientY):i instanceof TouchEvent&&(d=i.touches[0].clientX,h=i.touches[0].clientY))};e.addEventListener("mousedown",y),e.addEventListener("touchstart",y),e.addEventListener("mouseenter",()=>{o=!0}),e.addEventListener("mouseleave",()=>{o=!1}),window.addEventListener("mouseup",w),e.addEventListener("touchend",w),e.addEventListener("touchcancel",w),e.addEventListener("mousemove",b),e.addEventListener("touchmove",b)});const D=(e,t,l)=>{if(f.length>1e3)return;const o=e.getBoundingClientRect();if(t<o.left||t>=o.right||l<o.top||l>=o.bottom)return;const d=e.width/o.width,h=e.height/o.height,y=(t-o.left)*d,w=(l-o.top)*h,b=new Y(y,w);f.push(b)},j=(e,t,l)=>{const o=e.getBoundingClientRect(),d=e.width/o.width,h=e.height/o.height,y=(t-o.left)*d,w=(l-o.top)*h;f=f.filter(b=>b.pos.distance(new S(y,w))>50)},B=()=>{f.splice(0,f.length)},$=(e,t)=>{for(let l=0;l<=e.width/n.value;l++){t[l]=[];for(let o=0;o<=e.height/n.value;o++)t[l][o]=[]}for(let l of f)t[Math.floor(l.pos.x/n.value)][Math.floor(l.pos.y/n.value)].push(l)},G=(e,t,l)=>{for(let o=0;o<t.width/n.value;o++)for(let d=0;d<t.height/n.value;d++){let h=l[o][d].length;e.fillStyle="rgba(255, 255, 255, "+h/10+")",e.fillRect(o*n.value,d*n.value,n.value,n.value)}};return O(()=>{clearInterval(s)}),(e,t)=>(T(),k("div",A,[a("div",H,[a("div",J,[F(X,{value:"create",text:"Create",modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=l=>p.value=l)},null,8,["modelValue"]),F(X,{value:"delete",text:"Delete",modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=l=>p.value=l)},null,8,["modelValue"]),a("button",{onClick:B,class:"border border-white p-2"},"Clear")]),a("div",K,[a("span",null,"Search Radius "+_(n.value.toFixed(2)),1),M(a("input",{type:"range",min:"10",max:"100","onUpdate:modelValue":t[2]||(t[2]=l=>u.value=l),class:"w-full"},null,512),[[E,u.value,void 0,{number:!0}]])]),a("div",Q,[a("span",null,"Repel Force "+_(r.value),1),M(a("input",{type:"range",min:"0",max:"0.1",step:"0.001","onUpdate:modelValue":t[3]||(t[3]=l=>r.value=l),class:"w-full"},null,512),[[E,r.value,void 0,{number:!0}]])]),a("div",W,[a("span",null,"Gravity "+_(c.value),1),M(a("input",{type:"range",min:"0",max:"1",step:"0.1","onUpdate:modelValue":t[4]||(t[4]=l=>c.value=l),class:"w-full"},null,512),[[E,c.value,void 0,{number:!0}]])]),a("div",Z,[a("span",null,"Friction "+_(v.value),1),M(a("input",{type:"range",min:"0",max:"1",step:"0.01","onUpdate:modelValue":t[5]||(t[5]=l=>v.value=l),class:"w-full"},null,512),[[E,v.value,void 0,{number:!0}]])]),a("div",R,[a("span",null,"Max Speed "+_(m.value),1),M(a("input",{type:"range",min:"1",max:"20","onUpdate:modelValue":t[6]||(t[6]=l=>m.value=l),class:"w-full"},null,512),[[E,m.value,void 0,{number:!0}]])]),a("div",ee,[a("span",te,"Particles: "+_(x.value),1),a("button",{class:"border border-white p-2",onClick:t[7]||(t[7]=l=>N.value=!N.value)}," Toggle grid ")])]),le]))}}),se=a("h2",null,"Fluid Simulation",-1),ne=a("br",null,null,-1),ue=C({__name:"FluidView",setup(U){return(s,u)=>(T(),k(z,null,[se,F(oe),ne,F(q,{filename:"Fluid"})],64))}});export{ue as default};
